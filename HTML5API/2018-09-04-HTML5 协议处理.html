<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>HTML5 协议处理: Web-based Protocol Handlers # HTML5 API | 博客 @ 王晨旭的个人网站</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#08F">
	<link rel="stylesheet" href="/style/style.css">
	<link rel="stylesheet" href="/style/highlight/default.css">
	
	
	
	<script src="/script/highlight.pack.js"></script>
	<script src="/script/qrcode.min.js"></script>
	<script src="/script/script.js"></script>
	

</head>
<body>
	<header>
	<div id="open-header" onclick="this.parentNode.classList.toggle('open')"></div>
	<div id="header-bar">
		<a href="/" id="site-logo">
			<img src="/favicon.svg" />
			王晨旭的个人网站
		</a>
	</div>
	<nav>
		<ul>
			<li><a href="/">首页</a></li>
		<li><a href="/HTML5API">HTML5 API</a></li><li><a href="/server">服务器</a></li>
		</ul>


		
	</nav>
	<ul id="qrcode-links">
		<li title="微信公众号: 未来开发者(wangchenxu-net)"><a target="_blank" href="https://mp.weixin.qq.com/mp/profile_ext?action=home&amp;__biz=MzU3NjMxNDgzMw==" class="wechat-logo"></a><img src="/images/qrcode/wangchenxu-net.svg"/></li>
		<li title="码云: wangchenxu-net"><a target="_blank" href="https://gitee.com/wangchenxu-net" class="gitee-logo"></a></li>
		<li title="gitlab: wangchenxu-net"><a target="_blank" href="https://gitlab.com/wangchenxu-net" class="gitlab-logo"></a></li>
		<li title="github: wangchenxu-net"><a target="_blank" href="https://github.com/wangchenxu-net" class="github-logo"></a></li>
		<li title="捐助我：支付宝"><div class="alipay-logo"></div><img src="/images/qrcode/alipay.png"/></li>
		<li title="捐助我：微信支付"><div class="wepay-logo"></div><img src="/images/qrcode/wepay.png"/></li>
		<li title="电子邮箱"><a target="_blank" href="mailto:www@wangchenxu.net" class="email-logo"></a></li>
	</ul>
</header>
	<div>
	<div class="only-print" data-page-card data-title="HTML5 协议处理: Web-based Protocol Handlers"></div>
<main>
<div class="blog-info">
	<span class="blog-time">2018-09-04</span>
	<h1 class="blog-title">
		[<a href="/HTML5API">HTML5 API</a>]
	HTML5 协议处理: Web-based Protocol Handlers</h1>
</div>
<article class="blog-main style-context-box" need-article-nav>
	<h2 id="-">说明</h2>
<p>获取资源，是利用Web最重要的功能之一，但随着现代也有越来越多的应用改用Web设计，而这些应用中，是有不少原本可以处理其他协议的（例如邮箱应用可以处理<code>mailto:</code>协议），如果通过处理其他协议，需要手动复制粘贴或者需要先手动转成<code>http(s):</code>协议，显然是不方便的。为了解决这个问题，HTML5引入了“Web-based Protocol Handlers”，以便于直接点击其他协议的链接就可以直接用Web应用打开并处理。</p><h2 id="-">语法</h2>
<p>Web-based Protocol Handlers 只提供了一个方法。</p><h3 id="-">注册</h3>
<p>使用<code>registerProtocolHandler</code>方法用来注册处理程序，此方法扩展了<code>navigator</code>对象，具体语法如下：</p><pre><code class="ECMAScript">navigator.registerProtocolHandler(protocol, url, title);</code></pre>
<p>当一个浏览器执行这段代码时,它应该向用户显示一个请求,让用户许可为处理这个协议而注册一个web应用程序的请求。</p><h4 id="-">参数</h4>
<p><code>protocol</code>: 站点希望处理的协议，指定为字符串。例如，您可以注册处理SMS文本消息链接，通过注册来处理“短信”方案。</p><blockquote>
<p><em><strong>注意</strong></em> 协议必须属于白名单内的协议，或者以<code>web+</code>开头的协议。</p><table>
<thead>
<tr>
<th align="center">协议白名单</th>
<th align="center">-</th>
<th align="center">-</th>
<th align="center">-</th>
<th align="center">-</th>
</tr>
</thead>
<tbody><tr>
<td align="center">bitcoin</td>
<td align="center">geo</td>
<td align="center">im</td>
<td align="center">irc</td>
<td align="center">ircs</td>
</tr>
<tr>
<td align="center">magnet</td>
<td align="center">mailto</td>
<td align="center">mms</td>
<td align="center">news</td>
<td align="center">nntp</td>
</tr>
<tr>
<td align="center">sip</td>
<td align="center">sms</td>
<td align="center">smsto</td>
<td align="center">ssh</td>
<td align="center">tel</td>
</tr>
<tr>
<td align="center">urn</td>
<td align="center">webcal</td>
<td align="center">wtai</td>
<td align="center">xmpp</td>
<td align="center"></td>
</tr>
</tbody></table>
</blockquote>
<p><code>url</code>: 处理程序的URL，作为字符串。此字符串应包含“％s”作为占位符，将替换为要处理的文档的转义URL。此URL可能是真实的URL，也可能是电话号码，电子邮件地址等。</p><blockquote>
<p><em><strong>注意</strong></em> url参数必须为代码执行页面的同源url, 可以使相对url, 也可以是绝对url。</p></blockquote>
<p><code>title</code>: 在界面展示给的用户的协议处理程序标题。</p><h4 id="-">可能的错误</h4>
<p><code>SecurityError</code>: 用户代理阻止了协议处理程序的注册。如果指定了无效协议（例如“http”），则可能会发生这种情况，出于明显的安全原因无法注册。</p><p><code>SyntaxError</code>: 指定的协议处理程序URL中缺少“％s”字符串。</p><h3 id="-">激活</h3>
<p>当协议被注册后，只要用户点击使用对应协议的链接，浏览器将跳转到对应的web应用程序注册时提供的URL。</p><p>例如点击一下链接，就会打开用于处理<code>mailto:</code>协议的Web应用，除非此协议未被注册，则会打开操作系统的处理应用。</p><pre><code class="HTML">&lt;a href=&quot;mailto:webmaster@example.com&quot;&gt;Web Master&lt;/a&gt;</code></pre>
<h3 id="-">处理</h3>
<p>当用户要打开对应协议时，浏览器会自动跳转到对应的URL，例如<code>mailto:</code>注册到<code>https://www.example.com/?url=%s</code>，则点击上面的链接就会打开<code>https://www.example.com/?url=mailto%3Awebmaster%40example.com</code>，然后就可以直接使用服务器或者JavaScript处理。</p>
</article>
<div class="style-context-box not-print" data-clipboard-tip="此文链接:" data-clipboard-data data-clipboard-type="url"></div>
<div class="base-page-nav">
	
		<a href="/server/2019-03-29-Let-s-Encrypt-通配符证书申请教程.html" title="Let&#39;s Encrypt 通配符证书申请教程">上一篇：Let&#39;s Encrypt 通配符证书申请教程</a>
	
	
		<a href="/HTML5API/2018-08-07-HTML5 指针锁定API.html" title="HTML5 指针锁定API: Pointer Lock API">下一篇：HTML5 指针锁定API: Pointer Lock API</a>
	
</div>
<div class="only-print" data-page-card data-title="HTML5 协议处理: Web-based Protocol Handlers"></div>
<div class="not-print" id="cyReward" role="cylabs" data-use="reward"></div>
<div class="not-print" id="cyEmoji" role="cylabs" data-use="emoji"></div>
<div class="not-print" id="SOHUCS"></div>
</main>
<div class="not-print" id="more-list"></div>

</div>
	<footer>
	<div>
		&copy;2018- 2019
		<a href="//www.wangchenxu.net">王晨旭的网站</a>
		<script src="//s19.cnzz.com/stat.php?id=1274150741&show=pic"></script>
	</div>
</footer>
</body>
</html>
